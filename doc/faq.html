<?xml version="1.0" encoding="iso-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<title>FAQ: FreeTDS.org</title>
</head>
<body bgcolor="#f9f9f9">

<!-- generic header -->
<table width="100%">
<tr>
<td><img src="freetdslogo3.gif" alt="FreeTDS.org" /></td>
<td align="right" valign="bottom">
Home&nbsp;&nbsp;|&nbsp;
<a href="news.html">News</a>&nbsp;&nbsp;|&nbsp;
<a href="software.html">Software</a>&nbsp;&nbsp;|&nbsp;
<a href="docs.html">Documentation</a>&nbsp;&nbsp;|&nbsp;
<a href="support.html">Support</a>&nbsp;&nbsp;|&nbsp;
<a href="contrib.html">Contribute</a>
</td>
</tr>
</table>
<hr size="1" noshade="noshade" />


<!-- page specific content -->
<h1>FAQ</h1>

<p><font size="-1">

This is a list of frequently asked questions and answers about
FreeTDS.  It is updated between releases of FreeTDS to cover problems
since the last release.
<p>

On the other hand, the <a
href="http://www.freetds.org/userguide/book1.html">FreeTDS User
Guide</a>, included in each release, is the appropriate place for new
users to start.<p>

<div align=right><i>$Id: faq.html,v 1.11 2002/05/01 23:49:31 jklowden Exp $</i></div><p>

</font> </p>

<OL>
<li>
General Questions<ul>

<li>
<a href="#What is FreeTDS">What is FreeTDS?</a></li>

<li>
<a href="#Where_do_I_get_FreeTDS">Where do I get FreeTDS?</a></li>

<li>
<a href="#Does FreeTDS support MSSQL">Does FreeTDS support MSSQL?</a></li>

<li>
<a href="#Is there any documentation for the TDS protocol">Is there any documentation for the TDS protocol?</a></li>

<li>
<a href="#Is there other documentation I should know about">Is there other documentation I should know about?</a></li>

<li>
<a href="#How can I get help">How can I get help (or support)?</a></li>

<li>
<a href="#Who is responsible for FreeTDS">Who is responsible for FreeTDS?</a></li>

<li>
<a href="#Why LGPL license instead of license foo">Why LGPL license instead of license foo?</a></li>

</ul>

<li>
Implementation<ul>

<li>
<a href="#How to I access the CVS">How to I access the CVS?</a></li>

<li>
<a href="#Do_I_need_to_configure_anything">Do I need to configure anything?</a></li>

<li>
<a href="#SYBASE">What's this SYBASE environment variable for?</a></li>

<li>
<a href="#other environment variables">What other environment variables are there?</a></li>

<li>
<a href="#RPM">How do I install the RPM?</a></li>
</ul>

<li>
Programming:  C++, Sybperl, SQSH, &amp; PHP<ul>

<li>
<a href="#How do I compile Sybperl with FreeTDS">How do I compile Sybperl with FreeTDS?</a></li>

<li>
<a href="#How do I compile SQSH with FreeTDS">How do I compile SQSH with FreeTDS?</a></li>

<li>
<a href="#How do I compile PHP 3 with FreeTDS">How do I compile PHP 3 with FreeTDS?</a></li>

<li>
<a href="#Which Perl library should I use">Which Perl library should I use?</a></li>

<li>
<a href="#Are there any known issues">Are there any known issues?</a></li>

<li>
<a href="#thread safe">Is FreeTDS be thread safe?</a></li>

<li>
<a href="#class library">Any plans to write a C++ class library directly over TDS?</a></li>

<li>
<a href="#Are there plans to implement the OpenServer protocol/library">Are there plans to implement the OpenServer protocol/library?</a></li>

<li>
<a href="#jdbc test">How can test my FreeTDS JDBC Driver?</a></li>
<li>
<a href="basic_jdbc_question.html">What information do I need to supply 
	when asking about failures with the FreeTDS JDBC Driver?</a></li>
</ul>

<li>
Problems Building<ul>

<li>
<a href="#I get a message 'AM_PROG_LIBTOOL' not found">I get a message 'AM_PROG_LIBTOOL' not found</a></li>

<li>
<a href="#Getting it to work on Alpha">Getting it to work on Alpha</a></li>

<li>
<a href="#Apache/PHP core dumps on start up">Apache/PHP core dumps on start up</a></li>

<li>
<a href="#autoconf_problem">I get a message like "<tt>undefined symbol g_tds_err_handler</tt>" on Solaris.</a></li>

<li>
<a href="#DBD_Sybase093"><tt>DBD::Sybase 0.93</tt> doesn't compile.</a></li>

<li>
<a href="#build_macosx">Getting it to work on MAC OS X</a></li>

</ul>

<li>
Problems Running<ul>

<li>
<a href="#Why is my TDS protocol wrong">Why is my TDS protocol wrong since upgrading to 0.53?</a></li>

<li>
<a href="#unknownmarker">What does this <tt>unknown marker</tt> message mean? </a></li>

<li>
<a href="#connectionrefused">What if I get a 'connection refused' message?</a></li>

<li>
<a href="#integratedsecurity">The server is listening, but logins fail? (MS SQL only)</a></li>

<li>
<a href="#textdata">My <tt>text</tt> data are being truncated or are causing my client to break.</a></li>
<li>
<a href="#dateformat">My dates aren't formatted right!</a></li>
</ul>
</li>
</OL>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

<hr size="1" />
<h2>General Questions</h2>

<a name="What is FreeTDS"></a>
<h3> What is FreeTDS?</h3>

<p>FreeTDS is a free re-implementation of the TDS (Tabular Data Stream) protocol
that is used by Sybase and Microsoft for their database products. It currently
implements TDS 4.2, 5.0 and 7.0, and can communicate with
any Sybase product as well as Microsoft SQL Server.</p>

<p>FreeTDS comes with a low level library (the TDS layer) along with a
number of APIs (Application Programming Interfaces). The current APIs are DB-Lib,
CT-Lib, and ODBC.</p>

<p>A JDBC driver has also been contributed under a BSDish license and is
available from the download page. It does not require the FreeTDS C
libraries.</p>


<a name="Where_do_I_get_FreeTDS"></a>
<h3>Where do I get FreeTDS?</h3>

<p>You can get the latest FreeTDS from Metalab or its mirrors. See 
"Quick Links" on the <a href="http://www.freetds.org/">FreeTDS</a> home page.  You may also 
use CVS (on sourceforge.net); see the User Guide for details.  </p>

<p>If your firewall prevents FTP access, you can download the jdbc 
<a href="http://www.rksystems.com/freetds_jdbc.jar">jar file</a> via http.  </p>

<p>Your favorite operating system may have a package of some kind
available.  You might want to check there.  Occasionally someone
contributes a package here, which we keep around.  Post a message to
the list if you're looking for one and don't find one in the usual
places. </p>

<a name="Does FreeTDS support MSSQL"></a>
<h3>Does FreeTDS support MSSQL?</h3>

<p>Yes, as long as you configure the libraries with the 4.2 or 7.0 protocol
version. See the <a href="http://www.freetds.org/userguide/">User Guide</a> for details. </p>


<a name="Is there any documentation for the TDS protocol"></a>
<h3>Is there any documentation on the TDS protocol?</h3>

<p>Yes, there is some <a href="http://www.freetds.org/tds.html">preliminary documentation</a> available.</p>

<p>Sybase has also made the TDS 5.0 protocol documentation available
for free (price) download, however the license is too restrictive to be
used by developers of this project and the core developers have decided
to not obtain the documentation until all license issues are resolved.</p>


<a name="Is there other documentation I should know about"></a>
<h3>Is there other documentation I should know about?</h3>

<ul>
	<li>FreeTDS Users Guide, on <a
	href="http://www.freetds.org/userguide/book1.html">the web</a>
	or as a <a
	href="http://www.freetds.org/userguide.tgz">tarball</a>.</li>

	<li><a
	href="http://www.microsoft.com/sql/productdoc/">Microsoft's
	Books Online</a>.</li>
	<!-- goes to http://www.microsoft.com/sql/techinfo/productdoc/2000/default.asp -->
	<!-- valid as at 12th november 2001 -->

	<li><a
	href="http://www.SchemaMania.org/jkl/booksonline/SQLBOL70/">Microsoft
	Documentation</a> converted to HTML.</li>

	<li><a href="http://www.sybase.com/support/manuals">Sybase's
	Product Manuals</a>.</li>
	<!-- valid as at 12th november 2001 -->

</ul>

<a name="How can I get help"></a>
<h3>How can I get help (or support)?</h3>

<p>After reading this FAQ and the User Guide, you might want to look at the mailing list
<a href="http://franklin.oit.unc.edu/cgi-bin/lyris.pl?visit=freetds">archives</a>.  If you don't see
your question answered there (or, if you'd just like to learn more about what's going on with FreeTDS),
please subscribe to the 
<a href="http://www.freetds.org/contact.html">mailing list</a>.  Questions new and old are cheerfully
answered there.  Traffic is not high, normally around 10 messages a day.  
</p>
<p><i>Netiquette note</i>:  It's considered poor form to mail "help me" questions directly to the
developers of <i>any</i> free software project, this one included.  Please direct your question to the
list, where someone with the available time and expertise can help you.</p>

<a name="Who is responsible for FreeTDS"></a>
<h3>Who is responsible for FreeTDS?</h3>

<!-- table is due for an update, see AUTHORS file -->
<!-- table generated by /usr/pkgsrc/databases/freetds/work/freetds/./authors2html ("nospam." added later by hand)-->
<table>
<tr>
<td><a href="mailto:camber@nospam.ais.org">Brian Bruns</a></td>
<td>Started this crazy thing</td>
</tr>
<tr>
<td><a href="mailto:greggj@nospam.savvis.com">Gregg Jensen</a></td>
<td>Message handlers and extra datatype support and some sybperl stuff?</td>
</tr>
<tr>
<td><a href="mailto:psaar@nospam.fenar.ee">Arno Pedusaar</a></td>
<td>Donated his TDS4.2 code to the cause</td>
</tr>
<tr>
<td><a href="mailto:misa@nospam.dntis.ro">Mihai Ibanescu</a></td>
<td>GNUified the packet</td>
</tr>
<tr>
<td><a href="mailto:cts@nospam.internetcds.com">Craig Spannring</a></td>
<td>JDBC driver and CVS repository.</td>
</tr>
<tr>
<td><a href="mailto:mark@nospam.champ.tstonramp.com">Mark Schaal</a></td>
<td>Cleaned up message handling, bug fixes, ctlib unittests</td>
</tr>
<tr>
<td><a href="mailto:kevin@nospam.nol.org">Kevin Lyons</a></td>
<td>Various TDS bug fixes</td>
</tr>
<tr>
<td><a href="mailto:tetherow@nospam.nol.org">Sam Tetherow</a></td>
<td>Various TDS bug fixes</td>
</tr>
<tr>
<td><a href="mailto:geoff@nospam.farmline.com">Geoff Winkless</a></td>
<td>Lost connection stuff</td>
</tr>
<tr>
<td><a href="mailto:KenASeymour@nospam.yahoo.com">Ken Seymour</a></td>
<td>ODBC Driver Fixes</td>
</tr>
<tr>
<td><a href="mailto:gray@nospam.voicenet.com">Scott Gray</a></td>
<td>TDS 7.0 numeric support and bug fixes</td>
</tr>
<tr>
<td><a href="mailto:bkline@nospam.rksystems.com>">Bob Kline</a></td>
<td>NTEXT support</td>
</tr>
<tr>
<td><a href="mailto:andrey@nospam.eller.cz">Koscheev Andrey</a></td>
<td>negative money patch</td>
</tr>
<tr>
<td><a href="mailto:nicklaus@nospam.crusher.fnal.gov">Dennis Nicklaus</a></td>
<td>vxWorks port and fixes for dbdata() and SYBVARBINARY</td>
</tr>
<tr>
<td><a href="mailto:breynolds@nospam.comtime.com">Brandon M. Reynolds</a></td>
<td>fix for arbitrarily large queries under dblib.</td>
</tr>
<tr>
<td><a href="mailto:vorlon@nospam.netexpress.net">Steve Langasek</a></td>
<td>off by one fixes and autoconf byte size thing.</td>
</tr>
<tr>
<td><a href="mailto:mark@nospam.lilback.com">Mark J. Lilback</a></td>
<td>implementation of dbstrlen and dbstrcpy</td>
</tr>
<tr>
<td colspan="2">

Thanks go to the folks at A2i, Inc. <a href="http://www.a2i.com">http://www.a2i.com</a> for funding the development of dblib host file bulk copy and writetext support, and to Dave 
Poyourow there for helping with the debugging.

</td>
</tr>
</table>
<!-- end generated table -->
<p>(These addresses have been mangled to defy "spamaton" programs that mindlessly collect email addresses from the web.  To send email to anyone listed above, delete the "nospam." part of the address.)</p>

<a name="Why LGPL license instead of license foo"></a>
<h3>Why LGPL license instead of license foo?</h3>

<p>
LGPL was chosen because if you want a commercial client, you can buy them
from Sybase, Microsoft or others. I do believe BSDish licenses are better
in some cases, but not for something like this.</p>

<hr>
		<!-- Implementation -->

<h2>Implementation</h2>

<a name="How to I access the CVS"></a>
<h3>How do I access the CVS Repository?</h3>

<p>The CVS repository is maintained in two separate projects on <a href="http://www.sourceforge.net">SourceForge</a></p>

<ul>

<li>The TDS, dblib, ctlib, and ODBC libraries are in the <a
href="http://sourceforge.net/cvs/?group_id=33106">FreeTDS</a> project.
(The root for anonymous access is
<tt>:pserver:anonymous@cvs.freetds.sourceforge.net:/cvsroot/freetds</tt>,
the password is empty, and the module name is <tt>freetds</tt>)</li>

<!-- :pserver:anon-cvs@freetds.internetcds.com:/Repository -->
<li>The JDBC library is in the <a
href="http://sourceforge.net/cvs/?group_id=33291">JTDS</a> project.
(The root for anonymous access is
<tt>:pserver:anonymous@cvs.jtds.sourceforge.net:/cvsroot/jtds</tt>,
the password is empty, and the module name is <tt>jtds</tt>)</li>

</ul>
<p>Read-only access requires no password.  For the right to commit
changes, contact the Project Admins listed on the SourceForge project
summary pages.</p>
<p>To obtain the current CVS copy of FreeTDS</p>
<pre><small>cvs \
-d:pserver:anonymous@cvs.freetds.sourceforge.net:/cvsroot/freetds \
login

cvs -z3 \
-d:pserver:anonymous@cvs.freetds.sourceforge.net:/cvsroot/freetds \
checkout freetds</small></pre>

<p>Building from CVS is described in the file INSTALL.CVS, and
involves running the <tt>autogen.sh</tt> script to generate and run
<tt>configure</tt> then <tt>make</tt> and <tt>make install</tt>.</p>

<a name="Do_I_need_to_configure_anything"></a>
<h3>Do I need to configure anything?</h3>

<p>
When you untar the package you will need to run:
<br /><tt>$ ./configure</tt></p>
<p>You also have the following options you can add to the configure
statement:</p>
<dl><!-- second level list of terms -->
	<dt><tt>--with-tdsver=VERSION</tt></dt>
	<dd>specify the fallback TDS version 
	<br />(4.2, 4.6, 5.0, or 7.0) [default is 5.0].</dd>
	<dt><tt>--enable-msdblib</tt></dt>
	<dd>enable Microsoft APIs and behaviour for DBLib (useful only for porting Win32 dblib apps)</dd>
	<dt><tt>--enable-dbmfix</tt></dt>
	<dd>rename dbopen() to tdsdbopen() as a work around for dbm name
	conflict</dd>
	<dt><tt>--with-gnu-ld</tt></dt>
	<dd>assume the C compiler uses GNU ld [default=no]</dd>
	<dt><tt>--enable-shared</tt></dt>
	<dd>build shared libraries [default=yes]</dd>
	<dt><tt>--enable-static</tt></dt>
	<dd>build static libraries [default=yes]</dd>
</dl> <!-- end nested dictionary list -->

<p>
<b>IMPORTANT</b> You must either build with TDS version 4.2 to access Microsoft SQL
Server or Sybase prior to 10.0 or change these values to 4.2 at runtime! TDS 7.0 may also be used to talk to Microsoft
SQL Server 7 and above.</p>

<a name="SYBASE"></a>
<h3>What is this SYBASE environment variable?</h3>

<p>
Many programs look for the SYBASE environment variable in order to
find the libraries home. You will want to set this to the main tds
directory.  For example if your tds installation is in
<tt>/usr/local</tt>, then your SYBASE variable would be set to
<tt>/usr/local/freetds</tt>.</p>

<a name="other_environment_variables"></a>
<h3>What other environment variables are there?</h3>

<ul>
<li>
<tt>TDSVER</tt> will override the default TDS version, possible values are 4.2, 5.0,
and 7.0</li>

<li>
<tt>TDSDUMP</tt> will specify a location for a log file for debugging. Beware that
your database login passwords may be listed in this file.</li>

<li>
<tt>TDSPORT</tt> will override the default port for the server. Defaults are 1433
for TDS 4.2/7.0 and 4000 for TDS 5.0</li>
</ul>

<a name="RPM"></a>
<h3>How do I install the RPM?</h3>

<p>
<tt>rpm -ivh freetds-0.52-1.i386.rpm</tt> (as root) will install the
libraries.</p>
<p>
<tt>rpm -ivh freetds-devel-0.52-1.i386.rpm</tt> (as root) will install the
headers and other stuff needed to build other stuff.</p>

<hr>
		<!-- Programming -->

<h2>Programming:  C++, Sybperl, SQSH, &amp; PHP</h2>

<a name="How do I compile Sybperl with FreeTDS"></a>
<h3>How do I compile Sybperl with FreeTDS?</h3>

<a name="How do I compile SQSH with FreeTDS"></a>
<h3>How do I compile SQSH with FreeTDS?</h3>
<a name="How do I compile PHP 3 with FreeTDS"></a>
<h3>How do I compile PHP 3 with FreeTDS?</h3>
<p>
	Please refer to the <a href="http://www.freetds.org/userguide/">User Guide</a>.  
	
<p>One small PHP hint, mailed to the FAQ master in May 2001: </p>
	
<p>
In the mailing list archives I noticed a few people discussing a problem I
just had.
</p>
<blockquote>
<p>
An attempt to make a connection to a MS SQL server from PHP would fail,
leaving
a message in the Apache error log:
</p>
<pre>
        "connect: Network is unreachable
         DB-Library: Login incorrect"
</pre>
<p>
The problem turned out to be a very simple one to fix.
In the php.ini file under the sybase section, there is a directive that sets
the path
to the sybase interfaces file  "sybase.interface_file = "</p>
<p>
After uncommenting this and setting it to a reasonable value (ie.
/usr/local/freetds/interfaces),
things started working.</p>
</blockquote>

<a name="Which Perl library should I use"></a>
<h3>Which Perl library should I use?</h3>

<p>There are four options for using TDS and Perl to connect to a Sybase
or MSSQL database, DBD::Sybase, DBD::ODBC, DBD::FreeTDS, and Sybperl. 
</p>
<p>
From Mark Schaal:
<br />
<p>DBD::Sybase is the recommended option, and yes it does work with MSSQL.
You will need to install the perl DBI module and the FreeTDS package, particularly
the CTLib portion. Set your SYBASE environment variable to /usr/local/freetds
and install DBD::Sybase. Don't worry too much if some of the tests fail.
Do worry if the module doesn't compile. Make sure you have the most recent
version of FreeTDS installed. You can check the 
<a href="http://franklin.oit.unc.edu/cgi-bin/lyris.pl?visit=freetds">mailing list archives</a>
 or ask the mailing list for help.
</p>
<p>DBD::FreeTDS does not depend on the FreeTDS libraries. It is minimally
functional but it is considered alpha software and is not being actively
developed.
</p>
<p>From Michael Peppler (mpeppler@peppler.org):
<br />Sybperl is a thin wrapper around the Sybase C APIs. It's a lot more
mature than DBI/DBD::Sybase (I've been working on it for 9 years :-) and
it's maybe more natural to use for someone who already knows the Sybase
APIs (or MS's DBlibrary). It's a little more powerfull/flexible than DBI,
though obviously less portable. It's still actively maintained and developed
(by yours truly)
</p>
<p>From Brian:<br />
DBD::ODBC is the newest option available.  Its primary advantage is not having to load another DBI driver if you already have DBI::ODBC load for other systems.  On the downside, it may be a little less robust than DBD::Sybase.
</p>

<a name="Are there any known issues"></a>
<h3>Are there any known issues?</h3>

<p>Floating point values are truncated by one position in version 0.51.   Datatypes affected are <tt>flt8</tt>, <tt>numeric</tt>, and <tt>money</tt>.  Status: <i>Fixed in current CVS version</i>  as of 12 March 2001.  </p>
<p>
Columns of datatype <tt>ntext</tt> are sometimes truncated by one position with TDS protocol version 7.0.  Workaround: convert them to <tt>varchar(8000)</tt> (or <tt>varchar(4000)</tt> if unicode data).  Status: <i>Fixed in 0.52</i></p>
<p>
MSSQL-7.0 has a known bug when communicating with 
big-endian machines.  Columns of type 
MONEY and DATETIME are returned as little-endian regardless of 
what was requested.  There is a patch from Microsoft that fixes this.  Refer to the <a href="http://www.freetds.org/userguide/book1.html">User Guide</a> for further details.  </p>
<p>
Unicode&lt;-&gt;Ascii conversion is broken, except for languages whose alphabet is similar to that of English.  Specifically, although Microsoft SQL Server transmits all character data as Unicode (UCS2), and can store text in Unicode (<tt>nchar/nvarchar</tt>) columns, FreeTDS will translate Unicode to Ascii correctly only for languages -- such as, not coincidentally, English -- that use use the Latin alphabet..  A more general solution awaits an individual with an actual problem to solve, knowledge of a non-Latin language, and a willingness to facilitate testing.  Status: Fixed with <i>client charset</i> option in 0.53pre2</p>

<a name="thread_safe"></a>
<h3>Is FreeTDS thread safe?</h3>

<p>
TDS is designed to be thread safe in the following manner. Different threads
may all use seperate connections without interferring with each other.
Threads may not share a DBPROCESS or CS_CONNECTION without controlling
access via a mutex however.</p>

<a name="class_library"></a>
<h3>Any plans to write a C++ class library directly over TDS?</h3>
<p>
I have a JDBC-like class library written over dblib. I may port that (probably
not soon).</p>
<p>Another option may be using libodbc++, but I have not tested this.</p>

<a name="Are there plans to implement the OpenServer protocol/library"></a>
<h3>Are there plans to implement the OpenServer protocol/library?</h3>

<p>Not at this point, there is still much work to do on the client protocol.
But, <tt>libtdssrv</tt> will do the trick for some applications.</p>

<a name="jdbc_test"></a>
<h3>How can test my FreeTDS JDBC Driver?</h3>
<p>
           <a href="mailto:Seth.Rajkumar@GNI.co.uk">Rajkumar Seth</a> offers the following:
<pre>
  static void ftdsjdbc () {
    try {
    	// use your hostname and port number here
      String url = "jdbc:freetds:sqlserver://nt1:1433/master"; 
      String login = "sa"; // use your login here
      String password = "secret"; // use your password here

      if (false) { //Sybase 
        url = "jdbc:freetds:sybase://unix1:4100/master";
        login = "sa"; // use your login here
        password = "secret"; // use your password here
      }

      Class.forName("com.internetcds.jdbc.tds.Driver"); 
      
      //open a connection to the database
      Connection connection 
      	  = DriverManager.getConnection(url, login, password);
      //to get the driver version
      DatabaseMetaData conMD = connection.getMetaData();
      System.out.println("Driver Name:\t" + conMD.getDriverName());
      System.out.println("Driver Version:\t" + conMD.getDriverVersion());
      //create a statement
      Statement st = connection.createStatement();
      
      //execute a query
      ResultSet rs 
      	  = st.executeQuery("SELECT * FROM master.dbo.sysprocesses");

      // read the data and put it to the console
      while (rs.next()) {
        for (int j = 1; j &lt;= rs.getMetaData().getColumnCount(); j++) {
          System.out.print(rs.getObject(j) + "\t");
        }

        System.out.println();
      }

      //close the objects
      st.close();
      connection.close();
    }
    catch (Exception e) {
      e.printStackTrace();
    }
  }

</pre>
</p>

<hr>
		<!-- BUILDING -->

<h2>Problems Building</h2>

<a name="I get a message 'AM_PROG_LIBTOOL' not found"></a>
<h3>I get a message 'AM_PROG_LIBTOOL' not found</h3>


<p>
Since CVS is diff based, the <tt>aclocal.m4</tt> file doesn't get the
right date on it. Do a <kbd>touch aclocal.m4</kbd> and then do the
<kbd>make</kbd>. This was fixed in the 0.50 release.</p>


<a name="Getting it to work on Alpha"></a>
<h3>Getting it to work on Alpha</h3>

<p>
This is a 64-bit problem. The library itself uses typedef'd types when it
needs to read or write certain sized values, however the typedef's are
wrong for 64-bit architectures. So until a permanent solution is in place,
apply the following patch:</p>

<pre>
In include/tds.h replace:
	typedef long TDS_INT;
	typedef unsigned long TDS_UINT;
with
	typedef int TDS_INT;
	typedef unsigned int TDS_UINT;
</pre>
<p>
Update: fixed in 0.52
</p>


<!-- fixed in 0.53? -->

<a name="Apache/PHP core dumps on start up"></a>
<h3>Apache/PHP core dumps on start up</h3>

<p>
You'll probably need to compile FreeTDS with "--enable-dbmfix", then edit
PHP's "functions/sybase.c" file, and find any references to "dbopen" and
replace with "tdsdbopen", then compile and run etc...
</p>

<p>The reason for this is that Apache is linked against DBM which includes
a function named dbopen() too.</p>
<p>
Update: fixed in 0.53pre2, dbopen is now always a define to tdsdbopen
</p>

<!-- fixed in 0.53? -->

<a name="autoconf_problem"></a>
<h3>I get a message like "<tt>undefined symbol g_tds_err_handler</tt>" on Solaris.</h3>

<p>
There is a bug in the FreeTDS <tt>autoconf</tt> scripts on both Sparc and x86 platforms when linking to <tt>PHP</tt> and <tt>DBD::Sybase</tt>.
</p>
<p>
The workaround is to add "<font size="+1"><tt>-ltds</tt></font>" to the link command. 
</p>
<p>
For <tt>PHP</tt>, edit the <tt>EXTRA_LIBS</tt> line in <tt>config_vars.mk</tt>
</p>
<p>
For <tt>DBD::Sybase</tt> edit the Makefile after running <b><kbd>perl Makefile.PL</kbd></b>.  (Please send mail to the list if this doesn't help.)  
</p>
<p>
If you have a Solaris machine and the requisite <tt>autoconf</tt> skills to fix this, a patch would be appreciated.
</p>

<a name="DBD_Sybase093"></a>
<h3>I couldn't get DBD::Sybase 0.93 to compile.</h3>


<p>DBD::Sybase 0.93 uses some features of ct-lib not currently available
in FreeTDS, we are working on adding them.  Until then, try DBD::Sybase
0.91 which should work fine.  
</p>

<a name="build_macosx"></a>
<h3>Getting it to work on MAC OS X.</h3>


<p>FreeTDS prior to 0.53pre2 fails to build, reporting malloc.h as
being unavailable.  Solved in CVS on 8th November 2001.  Workaround is
to remove the <tt>#include malloc.h</tt> from
<tt>include/tds.h.in</tt>
</p>

<hr>
		<!-- RUNNING -->

<h2>Problems Running</h2>

<a name="Why is my TDS protocol wrong"></a>
<h3>Why is my TDS protocol wrong since upgrading to 0.53?</h3>

<p>You upgraded your FreeTDS library and now seem to be 
connecting at a different protocol version, but your interfaces file hasn't changed.  What gives?
</p>

<p>Between the 0.51 and 0.53 releases a lot of changes went into the 
configuration options.  Formerly, at least three different schemes existed
for specifying the protocol version: </p>

<table border=1>
	<tr>
		<td><b>Location</b></td>
		<td><b>Example format</b></td>
	</tr>
	<tr>
		<td>build-time (<tt>./configure</tt>)</td>
		<td>4.2</td>
	</tr>
	<tr>
		<td>interfaces file</td>
		<td>tds4.2</td>
	</tr>
	<tr>
		<td>TDSVER environment variable</td>
		<td>42</td>
	</tr>
</table>
<p>The preferred form is now 4.2 and 
the others are deprecated and have been or will be removed in subsequent 
releases.</p>

<a name="unknownmarker"></a>
<h3>What does this <tt>unknown marker</tt> message mean?</h3>

<p>Most of the time, it means you're not using the right protocol version.  That <i>can</i> happen even if your <tt>./configure</tt> was done correctly.  Try setting the <tt>TDSVER</tt> to 70.  If that works, double check your work.  If your interfaces file and ./configure were right, but you needed the environment variable anyway, please post a message to the list and help us track it down.  </p>

<a name="connectionrefused"></a>
<h3>What if I get a <tt><font size="+1">connection refused</font></tt>
message?</h3>

<p>You want to make sure:</p>
<ul>
<li>
your server is running,&nbsp;</li>

<li>
you can connect to it,&nbsp;</li>

<li>
your account has permissions in the database to execute your query.&nbsp;</li>
</ul>
<p>Steps:</p>
<ol>
<li>
Try <tt>telnet &lt;hostmachine> &lt;port></tt> and see if it's listening.
You should get some form of response from the server (actual text varies
by vendor &amp; version).<br />&nbsp;</li>

<li>
Check the interfaces file (<tt>$SYBASE/interfaces</tt>)&nbsp;</li>
</ol>

<ul>
<li>
You should see something like:<br />
<pre>
myserver
	query tcp ether 127.0.0.1 4000
	master tcp ether 127.0.0.1 4000
</pre>
A lot of people overlook the port number (<i>4000</i> in this example).<br /></li>
<li>
The default port for TDS 4.2/7.0 is 1433.</li>
 
<li>
The default port for TDS 5.0 is 4000.</li>

<li>
Oh, and replace <tt>127.0.0.1</tt> with the name/address of <tt>myserver</tt>.<br />&nbsp;</li>

<li>
Check your ./configure and
environment variables. The <tt>--with-tdsver</tt> determines what flavors
of the TDS protocol your build of FreeTDS <i>can</i> run (and will run,
by default); the $TDSVER variable determines what flavor it <i>will</i>
run.&nbsp; The following combinations are reasonable:</li>


<table>
<tr>
<td><b>Vendor</b></td>

<td><b>Version</b></td>

<td><b>TDS Version</b></td>

</tr>

<tr>
<td>Sybase</td>

<td>4.92+&nbsp;</td>

<td>5.0</td>
</tr>

<tr>
<td>Microsoft</td>

<td>6.0, 6.5</td>

<td>4.2</td>
</tr>

<tr>
<td>Microsoft</td>

<td>7.0/2000</td>

<td>7.0</td>
</tr>
<tr><td>&nbsp;</td></tr>
</table>
</ul>

<ol>
<li>
Edit the <b><tt>PWD</tt></b> file and try <tt>make check</tt>.  It will call unittests for libtds, ctlib, and dblib in that order</li>

<li>
Compile <font size="+1"><tt><a href="http://www.sqsh.org">sqsh</a></tt></font>
and try that before the more complicated stuff (PHP/Perl). If you can connect
with
<tt>sqsh</tt>, you don't have a FreeTDS problem.&nbsp;</li>

</ol>

<a name="integratedsecurity"></a>
<h3>The Microsoft SQL Server is listening, my configuration and environment
are set up per question 6.1, but logins still fail.</h3>

<p>Yeah, make sure you're not relying on integrated security.  Microsoft
supports two security models in three permutations:
</p>
<ol>
<li>
Windows NT Authentication Mode (Windows NT Authentication)</li>

<li>
Standard Mode (SQL Server Authentication)</li>

<li>
Mixed Mode (Windows NT Authentication and SQL Server Authentication)</li>
</ol>
<p>You need either Standard or Mixed mode. </p>
<p>"Windows NT Authentication", often called "integrated security", relies
on Microsoft's trusted connections and is not supported by FreeTDS. In
it, user's network security attributes are established at network login
time. When connecting to the database server, SQL Server uses Windows NT
facilities to determine the validated network username. SQL Server then
permits or denies login access based on that network username alone, without
requiring a separate login name and password.
</p>
<p>FreeTDS supports the traditional database security model, which Microsoft
terms "SQL Server Authentication" but is frequently known as "standard
security". Username+Password pairs have to be passed to the server explicitly.
</p>
<p>Mixed Mode allows users to connect using either authentication method.
Users who connect through a Windows NT account can make use of trusted
connections in either Windows NT Authentication Mode or Mixed Mode. After
successful connection to SQL Server, the security mechanism is the same
for both modes.
</p>
<p>
We are very close to getting domain authentication working.  If you have access to a SQL Server in domain authentication mode and can do a network trace, let us know!
</p>

<a name="textdata"></a>
<h3>My <tt>text</tt> data are being truncated or are causing my client to break.</h3>

<p>
The <tt>text</tt> data type is different from <tt>char</tt> and <tt>varchar</tt> types.  The maximum data length of a  <tt>text></tt> column is governed by the <tt>@@textsize</tt> variable on the server.  Microsoft <i>claims</i> in their documentation to use a default <tt>textsize</tt> of 4000 characters, but in fact their implementation is inconsistent.  Sometimes <tt>text</tt> columns are returned with a size of 2 GB!  
</p>
<p>
The best solution is to make sure you set <tt>@@textsize</tt> to a reasonable value when establishing a connection.  
</p>
<a name="dateformat"></a>
<h3>My dates aren't formatted right!</h3>
<p>
It's true.  Some dates turn out better than others.  
</p>
<p>If you think you're dates should look like <em>2001-12-13 17:58:55.000</em>, but you're seeing something like <em>Dec 13 2001 05:58PM</em> instead (or vice versa), you've bumped into driver behavior.  There's no standard governing the default character string representation of a datetime dataype.  Different drivers make different choices, and  your driver has chosen a representation for you.  
</p>Microsoft's ODBC driver (which is used by among other things the Query Analyzer tool) converts datetimes to an ISO format.  That format has the advantage of being all numeric, making sortable, unambiguaous, and locale-independent.  Db-lib and Ct-lib, in contrast, as well as the FreeTDS ODBC driver, use the <code>MMM DD YYYY hh:mm</code> format.  
<p>If you want to be sure your queries always return dates in a particular format, don't leave the formating up to the driver!  Use the <code>Convert</code> function, or the more modern <code>Cast</code> function if your server supports it.  
</p>
<p>There are two other date issues.  
<ol>
	<li>FreeTDS dates are restricted to the range supported by the standard C library, approximately from 1970 to 2038.  </li>
	<li>Big endian clients experience difficulty with Microsoft servers.  See <em>Known Issues</em> in the <a href="http://www.freetds.org/userguide/">User Guide</a>.  </li>
</ol>

</p>

		<!-- footer -->
</td>
</tr>
<tr>
<td colspan="2">
<hr size="1" /><font size="-1">Updates and comments <a href="mailto:jklowden@speakeasy.org">FreeTDS FAQ Master</a></font></td>
</tr>
</table>
</body>
</html>
